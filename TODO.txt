- add admin password change page
- edit_event/maintenance_day/public_holiday go back to edit_events
x add admin menu item to navbar when admin (-> admin.html)
x add admin menu item to navbar when staff (-> staff.html)

x login.html

x index.html
  x if not logged in, redirect to login.html?from=index.html

x admin password
x staff password (editable via super password)
x parent password (editable via staff password)

x session:
  x key : uid sent as cookie
  x level : admin||staff||parent
  x touched : server-time

x view: set<group> - sent as cookie

x terms:
  x number of terms
  x dates : [ (start date,end date) ]
  x editable via admin password edit-terms.html

x groups
  x editable via staff password
  x edit_groups.html
  x edit_groups.js
    x get
    x post
    x polish

- schema:
  x BoolType
  x allow literals (matches that literal)
  x OneOf(a,b,c) - match exactly one of the items
    (so OneOf('a','b','c') is an enum)
  - set(x) - set of x
  x IntType as dict key
  x StringType as dict key
  x embed Schema

- events.html
  x show group(s) selector
    x get/set cookie
    x generate options all,1,2,3,4,1+2,3+4,1+3,2+4
    x select option based on cookie
    x update cookie on change
  x new event link (staff only)
    x display form
    x save form
    x mce for description
  x calendar month
    x get current month via month_calendar and display
    x highlight days of groups-to-show
      x adjust month_calendar to return {'term':IntType,'week':IntType}||None as 'term_week' instead of 'name'
      x that way we know if it even or odd week for that term and
        can figure out which days group is on that week
)
    x fetch events for this month
      x query via months but how?
    x filter events by groups-to-show
    x allow date(s) select
  x use jquery date picker (edit_terms.js)
  ~ find colour picker (edit_event.html)
  x use mce (edit_event.html)
    
  x prev/next month links
  x delete event
  x go back to events on save event (and refresh)
  x test add dates to event, remove dates from event
  x edit_terms.js: on save return to previous page
  
x event.html
  x schema: {
      id: IntType,
      groups: [ IntType ],
      dates : [ {year:IntType,month:IntType,Day:IntType} ],
      name : {
        text:StringType,
        colour:StringType
      },
      description : {
        html : StringType
      }
  x calc weeks
  x calc events

- edit_event.html
  - edit_event.js
    x fetch event (for non-zero id passed in)
    x mce
    ~ name colour
    x save (return to calendar for monthToShow)


x terms start with monday/tue or monday/tue/wed, not per group
  x grey out of term
  x edit_terms
  x edit_groups
  x events
  
x public holidays separate - different background colour
x maintenance days separate and allow add names (you can
  see all names)
  x only one date per maintenance day
  x view allows add volunteer only

- allow edit maintenance day name
  x kindycal.py schema
  x kindycal.py maintenance_day_page
  x edit_maintenance_day.html
  x events.js
  x edit_maintenance_day.js

~ nav bar (make it mobile style always)
x start on events page
- login pages use referer to go to requested page after login
x return to previous month after edit/view event etc (via cookie?)
x new event etc init date from month cookie

x View Events for: All Groups
x grey out next/prev-months days

x time with your child
- roster jobs
- fair rosters

- upload document/image
  - logout (return to loginLevel login page)
  - rewrite mce dialogs as jquery ui dialogs with image:
         url ____   
         or file ____
         Next
         
         preview Change
         size
         title
         OK
    ... link:
         url ____ Upload...
         text (default to uploaded file name)
         OK (must have text)

An upload looks like:
Accept	text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding	gzip, deflate
Accept-Language	en-US,en;q=0.5
Connection	keep-alive
Cookie	kc-session=f903cc11c6f811e589f46d06fceec485; month-to-show="\173\012 \"m\": 2\054\012 \"y\": 2016\012\175"
Host	192.168.0.3:8080
Referer	http://192.168.0.3:8080/edit_event.html?id=100
User-Agent	Mozilla/5.0 (X11; Linux i686; rv:24.0) Gecko/20140429 Firefox/24.0 Iceweasel/24.5.0
R
Content-Length	29628
Content-Type	multipart/form-data; boundary=---------------------------2906405429423721941612351615

-----------------------------2906405429423721941612351615
Content-Disposition: form-data; name="filename"; filename="1003-orig.jpeg"
Content-Type: image/jpeg

xxxxx
-----------------------------2906405429423721941612351615--



INFO     2016-01-30 05:37:54,799 kindycal.py:37] {'Content-Type': 'multipart/form-data; boundary=---------------------------21355231821231987527755659472', 'Content_Type': 'multipart/form-data; boundary=---------------------------21355231821231987527755659472', 'Host': '192.168.0.3:8080', 'Referer': 'http://192.168.0.3:8080/edit_event.html?id=100', 'Content-Length': '225', 'X-Appengine-Country': 'ZZ', 'Accept-Language': 'en-US,en;q=0.5', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:24.0) Gecko/20140429 Firefox/24.0 Iceweasel/24.5.0', 'Cookie': 'kc-session=f903cc11c6f811e589f46d06fceec485; month-to-show="\\173\\012    \\"m\\": 2\\054\\012    \\"y\\": 2016\\012\\175"', 'Content_Length': '225'}

INFO     2016-01-30 05:28:46,376 kindycal.py:37] '-----------------------------14841912591767163687971027465\r\nContent-Disposition: form-data; name="filename"; filename="xxx.txt"\r\nContent-Type: text/plain\r\n\r\nxxx\n\r\n-----------------------------14841912591767163687971027465--\r\n'



INFO     2016-01-30 05:44:23,335 kindycal.py:37] {'Content-Type': 'multipart/form-data; boundary=-----------------------------14841912591767163687971027465', 'Content_Type': 'multipart/form-data; boundary=-----------------------------14841912591767163687971027465', 'Host': '192.168.0.3:8080', 'Content-Length': '225', 'X-Appengine-Country': 'ZZ', 'Cookie': 'kc-session=83d4ce47c71411e58e4d1513d253b538; Path=/', 'Content_Length': '225'}
INFO     2016-01-30 05:44:23,338 kindycal.py:37] '-----------------------------14841912591767163687971027465\r\nContent-Disposition: form-data; name="filename"; filename="xxx.txt"\r\nContent-Type: text/plain\r\n\r\nxxx\n\r\n-----------------------------14841912591767163687971027465--\r\n'


INFO     2016-01-30 05:36:46,739 kindycal.py:37] {'Content-Type': 'multipart/form-data; boundary=--e76d48a9843a14b8', 'Content_Type': 'multipart/form-data; boundary=--e76d48a9843a14b8', 'Host': '192.168.0.3:8080', 'Content-Length': '145', 'X-Appengine-Country': 'ZZ', 'Cookie': 'kc-session=73b7cf21c71311e5a0fd1513d253b538; Path=/', 'Content_Length': '145'}

INFO     2016-01-30 05:33:37,792 kindycal.py:37] '--44de7b2477ba1ea2\r\nContent-Disposition: form-data; name="filename"; filename="xxx.txt"\r\nContent-Type: text/plain\r\n\r\nxxx\n\r\n--44de7b2477ba1ea2--\r\n'


- @ndb.transactional
- ref count File
  File
    hash : IntegerProperty
    id : IntegerProperty
    mime_type
    data
    ref_count
- family information

- hash passwords

x fix + button after adding new date (use before rather than append)

- allow remove of stuff added during parent's session  

-----------------------

  /usr/local/google_appengine/appcfg.py -e xju360@gmail.com update .
  git status
  git push ~/kindycal.bare/
  /usr/local/google_appengine/dev_appserver.py --host 192.168.0.3 --datastore_path=~/kindycal-data --blobstore_path=~/kindycal-blob ~/kindycal/www

  git push https://github.com/urnest/bckindycal
